---
# pfSense connection configuration
# These should be overridden in inventory host_vars
pfsense_api_url: "https://{{ ansible_host }}:10443/api/v2"
pfsense_api_key: "{{ network.pfsense.api_key | default('') }}"
pfsense_hostname: "{{ inventory_hostname }}"
pfsense_validate_certs: false

# API vs PHP shell preferences
# The role will prefer API when available, fall back to PHP when necessary
pfsense_prefer_api: true

# DHCP configuration
pfsense_dhcp_static_mappings: []
# Example:
# pfsense_dhcp_static_mappings:
#   - interface: "lan"
#     mac: "00:11:22:33:44:55"
#     ipaddr: "192.168.1.100"
#     hostname: "server01"
#     domain: "lab.local"
#     descr: "Production Server"

pfsense_dhcp_pxe_config: {}
# Example:
# pfsense_dhcp_pxe_config:
#   interface: "lan"
#   next_server: "192.168.1.5"
#   tftp_server: "192.168.1.5"
#   use_http_boot: true
#   http_boot_url: "http://192.168.1.5/boot.ipxe"
#   filename_bios: "boot.ipxe"
#   filename_uefi: "http://192.168.1.5/boot.ipxe"

# DNS forwarding configuration
pfsense_dns_forwarders: []
# Example:
# pfsense_dns_forwarders:
#   - address: "8.8.8.8"
#     port: 53
#   - address: "8.8.4.4"
#     port: 53

# Firewall configuration
pfsense_firewall_aliases: []
# Example:
# pfsense_firewall_aliases:
#   - name: "INTERNAL_NETWORKS"
#     type: "network"
#     addresses:
#       - "172.23.10.0/24"
#       - "172.23.11.0/24"
#       - "172.23.12.0/24"
#     descr: "All internal networks"
#
#   - name: "ADMIN_PORTS"
#     type: "port"
#     addresses:
#       - "22"
#       - "80"
#       - "443"
#     descr: "Administrative service ports"

pfsense_firewall_rules: []
# Example:
# pfsense_firewall_rules:
#   - name: "Allow LAN to TFTP on tuareg"
#     interface: "lan"
#     action: "pass"
#     protocol: "udp"
#     source: "172.23.11.0/24"
#     destination: "172.23.11.5"
#     destination_port: "69"
#
#   - name: "Block guest VLAN to restricted networks"
#     interface: "opt5"
#     action: "block"
#     protocol: "any"
#     source: "172.23.50.0/24"
#     destination: "RESTRICTED_NETWORKS"  # Can use alias
#
#   - name: "Allow SSH to firewall from mgmt network"
#     interface: "lan"
#     action: "pass"
#     protocol: "tcp"
#     source: "172.23.11.0/24"
#     destination: "(self)"
#     destination_port: "22"

# ==============================================================================
# HAProxy & ACME Configuration
# ==============================================================================
# HAProxy backend configuration
pfsense_haproxy_backends: []
# Example:
# pfsense_haproxy_backends:
#   - name: "rhdc_inventory"
#     mode: "http"
#     balance: "roundrobin"
#     connection_timeout: 30000
#     server_timeout: 30000
#     check_type: "HTTP"
#     httpcheck_method: "GET"
#     monitor_uri: "/health"
#     servers:
#       - name: "tuareg"
#         address: "172.23.11.5"
#         port: 8081
#         ssl: false
#         check_inter: 2000
#
#   - name: "pfsense_gui"
#     mode: "http"
#     balance: "source"
#     connection_timeout: 30000
#     server_timeout: 30000
#     check_type: "SSL"
#     servers:
#       - name: "pfsense_local"
#         address: "127.0.0.1"
#         port: 10443
#         ssl: true
#         ssl_verify: false

# HAProxy frontend configuration
# NOTE: Use "rhdc_https_frontend" as the standard shared frontend for all RHDC apps
# This frontend already exists on pfSense and handles multiple applications
pfsense_haproxy_frontend_name: "rhdc_https_frontend"
pfsense_haproxy_frontends: []
# Example:
# pfsense_haproxy_frontends:
#   - name: "rhdc_https_frontend"  # Use the shared RHDC frontend
#     bind: "0.0.0.0:443"
#     mode: "http"
#     ssl: true
#     certificate: "lab_wildcard"
#     acls:
#       - name: "is_inventory"
#         expression: "hdr(host)"
#         value: "inventory.lab.rodhouse.net"
#       - name: "is_pfsense"
#         expression: "hdr(host)"
#         value: "hausa.lab.rodhouse.net"
#     actions:
#       - condition: "is_inventory"
#         backend: "rhdc_inventory"
#       - condition: "is_pfsense"
#         backend: "pfsense_gui"

# ACME certificate configuration
pfsense_acme_account: "letsencrypt_production"
pfsense_acme_email: ""  # Required for ACME registration
pfsense_acme_certificates: []
# Example:
# pfsense_acme_certificates:
#   - name: "lab_wildcard"
#     domains:
#       - domain: "*.lab.rodhouse.net"
#         method: "dns01"  # Requires DNS provider integration
#     renewafter: 60  # Days before expiry to renew
#
#   - name: "inventory_cert"
#     domains:
#       - domain: "inventory.lab.rodhouse.net"
#         method: "http01"  # HTTP-01 challenge
#     renewafter: 60

# Feature flags
pfsense_manage_dhcp: false
pfsense_manage_dns: false
pfsense_manage_firewall: false
pfsense_manage_haproxy: false
pfsense_manage_openvpn: false
pfsense_manage_backup: false

# ==============================================================================
# OpenVPN Management Configuration
# ==============================================================================
# OpenVPN certificate management
pfsense_manage_openvpn_certificates: true  # Update certificates when enabled
pfsense_openvpn_server_name: "LOCAL VPN TUNNEL"
pfsense_openvpn_certificate_name: "rodhouse-dot-net-wildcard"
pfsense_openvpn_expiration_threshold: 30  # Days before expiration to update

# ==============================================================================
# Backup Configuration
# ==============================================================================
pfsense_backup_dir: "/tmp/pfsense-backups"
pfsense_backup_prefix: "{{ pfsense_hostname | default('pfsense') }}"
pfsense_backup_retention_days: 30

# ==============================================================================
# General Settings
# ==============================================================================
pfsense_auto_confirm: false  # Set to true to skip confirmation prompts
pfsense_verbose: false  # Enable verbose output for debugging
